{% extends "analyzer/base.html" %} {% load static %} {% block body %}
<h1 class="text-center">These are the Anomalies observed:</h1>
<div class="container-fluid">
  <!-- 1st Headings Row -->
  <div class="row">
    <div class="col-4">
      <h2 class="text-center p-2">Insecure Services</h2>
    </div>
    <div class="col-4">
      <h2 class="text-center p-2">Malicious Domains</h2>
    </div>
    <div class="col-4">
      <h2 class="text-center p-2">Malicious IPs</h2>
    </div>
  </div>
  <div class="row">
    <!-- Vulnerable Services -->
    <div class="col-4 text-center vertical-separation">
      {% if not vuln_services %}
      <p>No vulnerable services detected.</p>
      {% else %} {% for service, entry_lst in vuln_services.items %}

      <button
        class="btn service-btn my-1"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#{{service}}"
        aria-expanded="false"
        aria-controls="{{service}}"
        >{{service.upper}}</button
      >
      {% endfor %} {% for service, entry_lst in vuln_services.items %}
      <div class="card collapse overflow-auto text-start" id="{{service}}">
        {% for entry in entry_lst %}
        <li class="list-group-item">Src. IP: <u>{{entry.src_ip}}</u>:<strong>{{entry.src_port}}</strong> --&gt; Dst. IP:
          <u>{{entry.dst_ip}}</u>:<strong>{{entry.dst_port}}</strong></li
        > {{entry.date_time}}</li>
        {% endfor %}
        <a href="https://www.speedguide.net/port.php?port={{entry_lst.0.dst_port}}">More Details</a>
      </div>
      {% endfor %} {% endif %}
    </div>
    <!-- Malicious Domains -->
    <div class="col-4 vertical-separation">
      {% if not sus_dom_entries %}
      <p>No malicious domains detected.</p>
      {% else %}
      <div class="card overflow-auto">
        {% for entry in sus_dom_entries %}
        <li class="list-group-item m-3"
          >Src. IP: <u>{{entry.src_ip}}</u> --&gt; Dst. IP:
          <u>{{entry.dst_ip}}</u><br>Malicious Domain:
          <strong style="color: #ff1144">{{entry.domain_name}}</strong></li
        >
        {% endfor %}
      </div>
      {% endif %}
    </div>
    <!-- Malicious IPs -->
    <div class="col-4">
      {% if not sus_ip_entries %}
      <p>No Malcious IP addresses detected.</p>
      {% else %}
      <div class="card overflow-auto">
        {% for entry in sus_ip_entries %}
        <li class="list-group-item m-3"
          >Src. IP: <u>{{entry.src_ip}}</u
          ><strong>{{entry.src_port}}</strong> --&gt; Dst. IP:
          <u>{{entry.dst_ip}}</u><strong>{{entry.dst_port}}</strong> <br>Malicious
          IP: <strong style="color: #ff1144">{{entry.mal_ip}}</strong></li
        >
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>
  <hr class="my-5" />
  <!-- 2nd Headings Row -->
  <div class="row">
    <div class="col-8">
      <h2 class="text-center p-2">DDoS and DoS Alerts</h2>
    </div>
  </div>
  <!-- DoS Attacks -->
  <div class="row">
    <div class="col-8 vertical-separation">
      {% if not dos_alerts %}
      <p>No DoS/DDoS attempts detected.</p>
      {% else %} 
      <div class="container-fluid" id="dos-alerts-cont">
        {% for alert in dos_alerts %}
        <ul class="list-group d-inline-block m-2" id="dos-alerts">
          <li class="list-group-item text-center" style="color:rgb(192, 16, 16)"><strong>{{alert.type}}</strong></li>
          <li class="list-group-item">Src. IP:<strong> {{alert.src_ip}}</strong></li>
          <li class="list-group-item">Targeted IP:<strong> {{alert.dst_ip}}</strong>{% if alert.dst_port %} Targeted port: <strong>{{alert.dst_port}}</strong>{% endif %}</li>
          <li class="list-group-item">Time:<strong> {{alert.start_time}}</strong></li>
          {% if alert.count %}<li class="list-group-item">Num of packets: <strong>{{alert.count}}</strong></li>{% endif %}
          {% if alert.size %}<li class="list-group-item">Size of packet: <strong>{{alert.size}}</strong> bytes</li>{% endif %}
        </ul>
          {% endfor %}
      </div>
      {% endif %}
    </div>
    <div class="col-4">
      <h5>The list on the left depicts all the potenital Distributed Denial of Service attacks detected withing the supplied capture file.</h5><br>
      <h5>Detection includes the following types of attacks:</h5>

      <ol class="list-group list-group-numbered d-inline-block">
        <li class="list-group-item"><strong>P</strong>ing <strong>o</strong>f <strong>D</strong>eath</li>
        <li class="list-group-item"><strong>ICMP</strong> Flood</li>
        <li class="list-group-item"><strong>UDP</strong> Flood</li>
        <li class="list-group-item"><strong>SYN</strong> Flood</li>
        <li class="list-group-item"><strong>HTTP</strong> Flood</li>
      </ol>

    </div>
  </div>
  <hr class="my-5" />
  <!-- 3rd Headings Row -->
  <div class="row">
    <div class="col-8">
      <h2 class="text-center p-2">Port Scanning Attempts</h2>
    </div>
  </div>
  <!-- Port Scans -->
  <div class="row">
    <div class="col-8 vertical-separation">
      {% if not scan_alerts %}
      <p>No port scans detected.</p>
      {% else %} 
      <div class="container-fluid" id="dos-alerts-cont">
        {% for alert in scan_alerts %}
        <ul class="list-group d-inline-block m-2" id="dos-alerts">
          <li class="list-group-item">Src. IP:<strong> {{alert.src_ip}}</strong></li>
          <li class="list-group-item">Targeted IP:<strong> {{alert.dst_ip}}</strong></li>
          <li class="list-group-item">Time:<strong> {{alert.start_time}}</strong></li>
          <li class="list-group-item">Ports Scanned: {% with alert.dst_ports|length as num_of_ports %}<strong>{{ num_of_port }}</strong>{% endwith %}
        {{alert.dst_ports|length}}</li>
        </ul>
          {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}
